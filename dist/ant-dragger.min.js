"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=_interopDefault(require("react")),PropTypes=_interopDefault(require("prop-types")),reactDnd=require("react-dnd"),ReactDOM=_interopDefault(require("react-dom")),HTML5Backend=_interopDefault(require("react-dnd-html5-backend"));function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,r){return e(r={exports:{}},r.exports),r.exports}var shallowEqual_1=createCommonjsModule(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,r){if(e===r)return!0;var t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(var o=Object.prototype.hasOwnProperty,a=0;a<t.length;a+=1){if(!o.call(r,t[a])||e[t[a]]!==r[t[a]])return!1;var i=e[t[a]],p=r[t[a]];if(i!==p)return!1}return!0}}),shallowEqual=unwrapExports(shallowEqual_1),BEGIN_DRAG="BEGIN_DRAG",END_DRAG="END_DRAG",DROP="DROP",HOVER="HOVER",ENTER="ENTER",LEAVE="LEAVE",CAN_DRAG="CAN_DRAG",CAN_DROP="CAN_DROP",classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},objectWithoutProperties=function(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},possibleConstructorReturn=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},Draggable=function(e){function r(){return classCallCheck(this,r),possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return inherits(r,e),createClass(r,[{key:"getChildContext",value:function(){return{dragSourceCreator:this.props.connectDragSource,dragCursor:this.props.dragCursor,dragHandlerType:this.props.dragHandlerType}}},{key:"componentDidMount",value:function(){var e=this.props,r=e.children,t=e.dragToken,n=e.draggerPreview,o=e.connectDragPreview;if(n&&"function"==typeof n){var a=n(t(),r.props);"function"==typeof a?a(o):"function"==typeof a.then?a.then(o):o(a)}}},{key:"componentDidUpdate",value:function(e,r){var t=this.props,n=t.dragToken,o=t.dispatcher,a=t.isOver,i=t.item,p=e.isOver;!p&&a?o(ENTER,{source:i&&i.$source,target:n(),props:this.props,component:this}):!a&&p&&o(LEAVE,{source:i&&i.$source,target:n(),props:this.props,component:this})}},{key:"render",value:function(){var e=this.props,r=e.children,t=(e.dispatcher,e.dragToken,e.dragCursor),n=e.draggingHint,o=e.dragHandlerType,a=e.wrapTag,i=e.wrapStyle,p=e.wrapClassName,s=e.draggerPreview,c=e.connectDragSource,g=e.connectDropTarget,d=e.connectDragPreview,l=e.isDragging,u=(e.isOver,e.item,e.itemType,e.differenceFromInitialOffset),f=(e.initialClientOffset,e.initialSourceClientOffset,e.clientOffset,e.sourceClientOffset,objectWithoutProperties(e,["children","dispatcher","dragToken","dragCursor","draggingHint","dragHandlerType","wrapTag","wrapStyle","wrapClassName","draggerPreview","connectDragSource","connectDropTarget","connectDragPreview","isDragging","isOver","item","itemType","differenceFromInitialOffset","initialClientOffset","initialSourceClientOffset","clientOffset","sourceClientOffset"])),h=p;"string"!=typeof h&&"function"==typeof h.join&&(h=h.join(" "));var y=_extends({cursor:"default"!==o?"auto":t},i),D=_extends({className:h,style:y},f),T=r;if("string"!=typeof T&&(T=React.Children.only(T)),l&&"function"==typeof n&&null!==u){var v=n(D,T);v&&(D=v)}return T="string"!=typeof T.type?React.createElement(a,D,T):React.cloneElement(T,_extends({},T.props,D,{style:_extends({},T.props.style,D.style)})),s||(T=d(T)),"default"===o&&(T=c(T)),g(T)}}]),r}(React.Component);Draggable.childContextTypes={dragSourceCreator:PropTypes.func,dragCursor:PropTypes.string,dragHandlerType:PropTypes.string};var DraggableWrapper=function(e){function r(e,t){classCallCheck(this,r);var n=possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return n.dragSource={beginDrag:n.dispatchBeginDragEvent.bind(n),endDrag:n.dispatchEndDragEvent.bind(n),canDrag:n.dispatchCanDragEvent.bind(n)},n.dropTarget={hover:n.dispatchHoverEvent.bind(n),drop:n.dispatchDropEvent.bind(n),canDrop:n.dispatchCanDropEvent.bind(n)},n.cachedWrapped=void 0,n}return inherits(r,e),createClass(r,[{key:"componentWillUnmount",value:function(){this.cachedWrapped=void 0}},{key:"dispatchBeginDragEvent",value:function(e,r,t){var n=this.props.dragToken(),o=this.context.dispatcher(BEGIN_DRAG,{source:n,props:e,component:t});return void 0===o&&(o={}),void 0===o.dragToken&&(o.dragToken=n),o.$target=o.$source=o.dragToken,o}},{key:"dispatchEndDragEvent",value:function(e,r,t){var n=r.getItem(),o=n.$target,a=n.$source;this.context.dispatcher(END_DRAG,{target:o,source:a,props:e,component:t})}},{key:"dispatchCanDragEvent",value:function(e,r){var t=this.props.dragToken(),n=this.context.dispatcher(CAN_DRAG,{source:t,props:e});return void 0===n&&(n=!0),n}},{key:"dispatchHoverEvent",value:function(e,r,t){var n=t.props.dragToken(),o=r.getItem().$source;if(!shallowEqual(n,o)||n!==o){r.getItem().$target=n;var a=this.context.dispatcher(HOVER,{target:n,source:o,props:e,component:t});return a&&a.constructor===n.constructor&&(r.getItem().$target=a),a}}},{key:"dispatchDropEvent",value:function(e,r,t){var n=r.getItem(),o=n.$target,a=n.$source;return this.context.dispatcher(DROP,{target:o,source:a,props:e,component:t})}},{key:"dispatchCanDropEvent",value:function(e,r){var t=r.getItem(),n=t.$target,o=t.$source,a=this.context.dispatcher(CAN_DROP,{target:n,source:o,props:e});return void 0===a&&(a=!0),a}},{key:"render",value:function(){var e=this.props,r=e.children,t=e.dragToken,n=e.dragCursor,o=e.draggingHint,a=e.wrapTag,i=e.wrapStyle,p=e.wrapClassName,s=objectWithoutProperties(e,["children","dragToken","dragCursor","draggingHint","wrapTag","wrapStyle","wrapClassName"]),c=this.context,g=c.dispatcher,d=c.draggerType,l=c.draggerPreview;this.cachedWrapped||(this.cachedWrapped=reactDnd.DragSource(d,this.dragSource,function(e,r){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:r.isDragging(),initialClientOffset:r.getInitialClientOffset(),initialSourceClientOffset:r.getInitialSourceClientOffset()}})(reactDnd.DropTarget(d,this.dropTarget,function(e,r){return{connectDropTarget:e.dropTarget(),isOver:r.isOver({shallow:!0}),item:r.getItem(),itemType:r.getItemType(),differenceFromInitialOffset:r.getDifferenceFromInitialOffset(),clientOffset:r.getClientOffset(),sourceClientOffset:r.getSourceClientOffset()}})(Draggable)));var u=this.cachedWrapped,f={dragCursor:n,draggingHint:o,wrapTag:a,wrapStyle:i,wrapClassName:p,draggerPreview:l,dragToken:t,dispatcher:g};return React.createElement(u,_extends({},f,s),r)}}]),r}(React.Component);DraggableWrapper.contextTypes={dispatcher:PropTypes.func,draggerType:PropTypes.string,dragDropManager:PropTypes.object,draggerPreview:PropTypes.func},DraggableWrapper.propTypes={dragToken:PropTypes.func.isRequired,draggingHint:PropTypes.func,dragHandlerType:PropTypes.oneOf(["default","handler"]),dragCursor:PropTypes.oneOf(["default","move","pointer"]),wrapTag:PropTypes.string,wrapStyle:PropTypes.object,wrapClassName:PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.string),PropTypes.string])},DraggableWrapper.defaultProps={wrapTag:"div",dragCursor:"default",dragHandlerType:"default",wrapStyle:{},wrapClassName:""};var _EVENT_FUNC,eventDispatcher=function(e){return function(r,t){return e(r,t)}},eventCreator=function(e,r){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={source:e,target:r},o={item:t.item,itemType:t.itemType,isDragging:t.isDragging,isOver:t.isOver,differenceFromInitialOffset:t.differenceFromInitialOffset,initialClientOffset:t.initialClientOffset,initialSourceClientOffset:t.initialSourceClientOffset,clientOffset:t.clientOffset,sourceClientOffset:t.sourceClientOffset};return _extends({},n,o)}},EVENT_FUNC=(defineProperty(_EVENT_FUNC={},BEGIN_DRAG,"onDragStart"),defineProperty(_EVENT_FUNC,END_DRAG,"onDragEnd"),defineProperty(_EVENT_FUNC,HOVER,"onDragging"),defineProperty(_EVENT_FUNC,ENTER,"onDragEnter"),defineProperty(_EVENT_FUNC,LEAVE,"onDragLeave"),defineProperty(_EVENT_FUNC,DROP,"onDrop"),defineProperty(_EVENT_FUNC,CAN_DRAG,"canDrag"),defineProperty(_EVENT_FUNC,CAN_DROP,"canDrop"),_EVENT_FUNC),noop=function(){},Dragger=function(e){function r(e,t){classCallCheck(this,r);var n=possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return n.notifyHandler=n.notifyHandler.bind(n),n.dispatcher=eventDispatcher(n.notifyHandler),n}return inherits(r,e),createClass(r,[{key:"getChildContext",value:function(){return{dispatcher:this.dispatcher,draggerType:this.props.draggerType,draggerPreview:this.props.draggerPreview}}},{key:"notifyHandler",value:function(e,r){var t=r.target,n=r.source,o=r.props,a=r.component,i=this.props[EVENT_FUNC[e]];return e!==CAN_DROP||i||(i=this.props.canDrag),i||console.warn("Unknown event type",e),i&&i(eventCreator(n,t)(o),o,a)}},{key:"render",value:function(){return(0,this.props.connectDropTarget)(React.Children.only(this.props.children))}}]),r}(React.Component);Dragger.propTypes={onDragStart:PropTypes.func,onDragEnd:PropTypes.func,onDrop:PropTypes.func,onDragging:PropTypes.func,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,canDrag:PropTypes.func,canDrop:PropTypes.func,draggerType:PropTypes.string,draggerPreview:PropTypes.func},Dragger.defaultProps={onDragStart:noop,onDragEnd:noop,onDrop:noop,onDragging:noop,onDragEnter:noop,onDragLeave:noop,canDrag:function(){return!0},canDrop:void 0,draggerType:"__dragger__",draggerPreview:void 0},Dragger.childContextTypes={dispatcher:PropTypes.func,draggerType:PropTypes.string,draggerPreview:PropTypes.func},Dragger.contextTypes={dragDropManager:PropTypes.object};var Wrapper=function(e){function r(e){classCallCheck(this,r);var t=possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));if(t.dropTarget={hover:t.handleContainerHover.bind(t)},t.edgeWidth=t.props.edgeWidth,"number"==typeof t.edgeWidth){var n=t.edgeWidth;t.edgeWidth={left:n,top:n,right:n,bottom:n}}return t.cachedWrapped=void 0,t}return inherits(r,e),createClass(r,[{key:"componentWillUnmount",value:function(){this.cachedWrapped=void 0}},{key:"componentDidMount",value:function(){this.refreshBoundingRect()}},{key:"componentDidUpdate",value:function(){this.refreshBoundingRect()}},{key:"handleContainerHover",value:function(e,r,t){var n=r.getClientOffset(),o=n.x,a=n.y,i=this.containerBoundingRect,p=i.left,s=i.top,c=i.right,g=i.bottom,d=this.edgeWidth,l={left:p+d.left,top:s+d.top,right:c-d.right,bottom:g-d.bottom},u={left:o<=l.left,top:a<=l.top,right:o>=l.right,bottom:a>=l.bottom};(u.left||u.top||u.right||u.bottom)&&this.props.onDragEdge({strike:u,client:{x:o,y:a},edge:l,itemType:r.getItemType(),initialClientOffset:r.getInitialClientOffset(),initialSourceClientOffset:r.getInitialSourceClientOffset(),clientOffset:r.getClientOffset(),sourceClientOffset:r.getSourceClientOffset(),differenceFromInitialOffset:r.getDifferenceFromInitialOffset()},e,t)}},{key:"refreshBoundingRect",value:function(){var e=this;setTimeout(function(){var r=ReactDOM.findDOMNode(e);e.containerBoundingRect=r.getBoundingClientRect()},0)}},{key:"render",value:function(){this.cachedWrapped||(this.cachedWrapped=reactDnd.DropTarget(this.props.draggerType,this.dropTarget,function(e,r){return{connectDropTarget:e.dropTarget()}})(Dragger));var e=this.cachedWrapped;return React.createElement(e,this.props,this.props.children)}}]),r}(React.Component);Wrapper.propTypes={onDragEdge:PropTypes.func,edgeWidth:PropTypes.oneOfType([PropTypes.number,PropTypes.object]),draggerType:PropTypes.string},Wrapper.defaultProps={onDragEdge:noop,edgeWidth:20,draggerType:"__dragger__"};var _DraggerContext=reactDnd.DragDropContext(HTML5Backend),DraggerHandler=function(e){function r(){return classCallCheck(this,r),possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return inherits(r,e),createClass(r,[{key:"render",value:function(){var e=this.context,r=e.dragSourceCreator,t=e.dragHandlerType,n=e.dragCursor,o=_extends({cursor:n},this.props.style),a=this.props.className,i=this.props.children;if("handler"===t){var p=this.props.wrapTag;i=r(React.createElement(p,{className:a,style:o},i))}return i}}]),r}(React.Component);DraggerHandler.contextTypes={dragSourceCreator:PropTypes.func,dragHandlerType:PropTypes.string,dragCursor:PropTypes.string},DraggerHandler.propTypes={wrapTag:PropTypes.string},DraggerHandler.defaultProps={wrapTag:"div"};var Draggable$1=DraggableWrapper,Dragger$1=Wrapper,DraggerContext=_DraggerContext,DraggerHandler$1=DraggerHandler,index={Draggable:Draggable$1,Dragger:Dragger$1,DraggerContext:DraggerContext,DraggerHandler:DraggerHandler$1};exports.Draggable=Draggable$1,exports.Dragger=Dragger$1,exports.DraggerContext=DraggerContext,exports.DraggerHandler=DraggerHandler$1,exports.default=index;
//# sourceMappingURL=ant-dragger.min.js.map
